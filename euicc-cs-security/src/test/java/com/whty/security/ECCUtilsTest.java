package com.whty.security;

import org.junit.Test;

import com.whty.security.ecc.ECCUtils;

public class ECCUtilsTest {
	private static String sp = "ffffffff00000001000000000000000000000000ffffffffffffffffffffffff";
	private static String sa = "FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC";
	private static String sb = "5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b";
	private static String sGx = "6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296";
	private static String sGy = "4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5";
	private static String sn = "FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551";
	private static String sh = "1";
	private static String sM= "6311D8B8F7FEE3E57060E3FE8C1FBDD4AC6741C02A88706C3E51FE150846008C";
	private static String sDA = "23019D1156F3E0ABB23D64B228B0A8149B009CCDEED281EE23686011900E0DC9";
	@Test
	public void createECCKeyPair(){
		for (int i = 0; i < 1000; i++) {
		System.out.println(ECCUtils.createECCKeyPair(sp, sa, sb, sGx, sGy, sn, sh));
		}
	}
	
	@Test
	public void eccECKASign(){
		for (int i = 0; i < 1000; i++) {
			System.out.println(ECCUtils.eccECKASign(sp, sa, sb, sGx, sGy, sn, sh, sM, sDA));
		}
	}
	
	@Test
	public void eccKeyAgreement(){
		String sp = "A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377";
		String sa = "7D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9";
		String sb = "26DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B6";
		String sGx = "8BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262";
		String sGy = "547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997";
		String sn = "A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A7";
		String sh = "1";
		String spbx = "4313684398B9CB3AC22D56CE31FC88875B4050E0A403D3DED15BD0C0537C3ECB";
		String spby = "6311D8B8F7FEE3E57060E3FE8C1FBDD4AC6741C02A88706C3E51FE150846008C";
		String sDA = "23019D1156F3E0ABB23D64B228B0A8149B009CCDEED281EE23686011900E0DC9";
		String sShareInfo = "01020304";
		int iKeylen = 64;
		for (int i = 0; i < 1000; i++) {
		System.out.println(ECCUtils.eccKeyAgreement(sp, sa, sb, sGx, sGy, sn, sh, sDA, spbx, spby, sShareInfo, iKeylen));
		}
	}
	
	@Test
	public void createECCPubKeyByDa(){
		for (int i = 0; i < 1000; i++) {
			System.out.println(ECCUtils.createECCPubKeyByDa(sp, sa, sb, sGx, sGy, sn, sh, sDA));
		}
	}
	
	@Test
	public void eccECKAVerify(){
		String sp = "A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377";
		String sa = "7D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9";
		String sb = "26DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B6";
		String sgx = "8BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262";
		String sgy = "547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997";
		String sn = "A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A7";
		String sh = "1";
		String spax = "1BD2F9B66941DAA62578849D30611F2F6CD8D66179E591D0130A3B0826C44CA1";
		String spay = "46AD78DEA2BC3AE951F5ADE59A78BEDE0E77DC8CC8FCDFA85578CC574F1D8C81";
		String sM = "6311D8B8F7FEE3E57060E3FE8C1FBDD4AC6741C02A88706C3E51FE150846008C";
		String sR = "5AF884A9CA42B233F04D443983A18A65D8C40EBDC076EC606DE5759345BCF74B";
		String sS = "A0C3FD88DC84B76B8D66D821647B25655162C44C4F4F1319C5059A5ABE3B5837";
		for (int i = 0; i < 1000; i++) {
			System.out.println(ECCUtils.eccECKAVerify(sp, sa, sb, sgx, sgy, sn, sh, sM, spax, spay, sR, sS));
		}
	}

}

package com.whty.euicc.rsp.tls;

import org.junit.Test;
import com.whty.euicc.rsp.packets.message.MessageHelper;
import com.whty.euicc.rsp.packets.message.request.AuthenticateClientReq;
import com.whty.euicc.rsp.packets.parse.EuiccMsgParse;
import com.whty.tls.client.ecc.EccCardShakeHandsClient;

public class AuthenticateClientTest {
	String path = "/gsma/rsp2/es9plus/authenticateClient";
	String type = "application/json";
	
	@Test
	public void authenticateClientTest()throws Exception{
		String data = EuiccMsgParse.prepareHttpParam(path,type,reqBodyByBean());
		String data2 = EuiccMsgParse.prepareHttpParam(path,type,"");
		String serverResult = new EccCardShakeHandsClient().clientTestByRsp(data, "127.0.0.1", 8765, data2, null);
		System.out.println("serverResult >> \n" + serverResult);
	}
	
	private String reqBodyByBean(){
		AuthenticateClientReq req = new AuthenticateClientReq();
		req.setTransactionId("80081122334455667700");
		req.setEuiccSigned1("3082018380081122334455667700830400010203841039B32D12074D4DC8644366BB428B26A6BF2282014C810302000082030200008303010000840D81010682040009C04083023A26850301DC2A86030202028703020202880204D0A94204143BD3F57B34F44436E08F028B5101C0E0A9B0986E0414012A83706174DEF23D357DE977DBC3EEAC5A66E00414856BF2B42E451591A70107C09548A0111B25DF61AA4204143BD3F57B34F44436E08F028B5101C0E0A9B0986E0414012A83706174DEF23D357DE977DBC3EEAC5A66E00414856BF2B42E451591A70107C09548A0111B25DF618B010199010004030101000C4010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000AC448020002000000000000000000000000000000000000000000000000000000000000081200030000000000000000000000000000000000000000000000000000000000000A00EA00C80080102030405060708A100");
		req.setEuiccSignature1("5F37404C93528D2BC151D11B3BD58FB4C1700E38B68A2873232674E24188C3F5562693229FACEB0A290C7CA3253D7B947C253DDEB9E8045EE6AE9F013E40E9248F72DB");
		req.setEuiccCertificate("30820213308201B9A00302010202060158F741F720300A06082A8648CE3D04030230763124302206092A864886F70D010901161563616F6C7433406368696E61756E69636F6D2E636E311B301906035504030C12544553542045554D205075626C69632043413111300F060355040A0C08544553542045554D3111300F06035504070C08424549204A494E47310B300906035504060C02434E3022180F32303136313231333038313732355A180F32303137303631333038313732355A303A31293027060355040513203839303031313232333334343535363637373838393941414242434344444545310D300B060355040A0C0441434D453059301306072A8648CE3D020106082A8648CE3D030107034200041ED227965ED396101F84B3E34AB3C183866EDC978841E0B0974818663A29D961B3BA47A977376EA25F649B1BF361544269E818108D6479ACB1C0198F5C28A7C0A36B3069301F0603551D2304183016801432C21C5298386C498E0DA135E7D400A0275C6084301D0603551D0E04160414E1840A94CA02FCC4258381CF30FA3ECBF691E74E300E0603551D0F0101FF04040302008030170603551D200101FF040D300B3009060767811201020101300A06082A8648CE3D040302034800304502205991E8FF88121D62E42D3EE4504CFD039802FDCABD22DEA6E5668D5FA042B022022100D7E52F21AD41DC6A202CAE2773EF7A9E6BD7500AECA375603DB1BEDF1F79F38B");
		req.setEumCertificate("30820319308202BFA00302010202060158F741F5EA300A06082A8648CE3D0403023053311D301B06035504030C144368696E6120556E69636F6D206553494D204341310E300C060355040B0C055653454E5331153013060355040A0C0C4368696E6120556E69636F6D310B300906035504060C02434E3022180F32303136313231333038313732345A180F32303137303631333038313732345A30763124302206092A864886F70D010901161563616F6C7433406368696E61756E69636F6D2E636E311B301906035504030C12544553542045554D205075626C69632043413111300F060355040A0C08544553542045554D3111300F06035504070C08424549204A494E47310B300906035504060C02434E3059301306072A8648CE3D020106082A8648CE3D0301070342000475A1D8292CE1A4405DEA59A15217590E1FB9B349C0AEB18EEABB3B7C511283904B0414834D3BD01FE6CA4EB03611FBC61D32528ABA906FF46A954308560315DA382015630820152301F0603551D230418301680143BD3F57B34F44436E08F028B5101C0E0A9B0986E301D0603551D0E0416041432C21C5298386C498E0DA135E7D400A0275C6084300E0603551D0F0101FF04040302000630170603551D200101FF040D300B300906076781120102010230120603551D130101FF040830060101FF02010030150603551D11040E300C880A2B0601040182F5460202303C0603551D1E0101FF04323030A02C302AA42830263111300F0603550405130838393030313132323111300F060355040A0C08544553542045554DA100307E0603551D1F047730753039A037A0358633687474703A2F2F31302E3139332E33302E33333A383138312F474443412F47445343415F50532F43524C43657274692E43524C3038A036A0348632687474703A2F2F31302E3139332E33302E33362F5441535343412F5441535343415F45554D2F43524C43657274692E43524C300A06082A8648CE3D0403020348003045022100C4607FC83A3FAA8FAB0394F9EFA87768FB45DC7B82C9C75F5D3A8AA1C75301180220608F002F8F60FCEE1266948B82978017712A482CEF6080623AEB0A1C243B3030");
		return MessageHelper.gs.toJson(req);
	}

}

package com.whty.euicc.rsp.profile;

import java.util.List;

import org.junit.Test;

import com.whty.euicc.rsp.lpa.profile.ProfileUtil;
import com.whty.euicc.rsp.utils.ApduUtils;

public class ApduUtilsTest {
	
	@Test
	public void getEUICCInfo1ApduTest() {
		System.out.println(ApduUtils.getEuiccInfo1Apdu());
	}
	
	@Test
	public void getEUICCChallengeApduTest() {
		System.out.println(ApduUtils.getEUICCChallengeApdu());
	}
	
	@Test
	public void authenticateServerApduTest() {
		String smdpSigned1 = "30348008a8f2f59744434e6e8010000102030405060708090A0B0C0D0E0F830400010203841040d24a506c394d29803a3dda36c0ccd5";
		String smdpSignature1 = "5F3740F8FDB22A34A5FFF0E5C56FEA1F9F1416AD497EA06FE4CAE141668FD7C0D5E7D6BB827BCDD0A1B5D840F64634CB576579831864600B35035DE17169F1242B9C39";
		String euiccCiPKIdToBeUsed = "04143bd3f57b34f44436e08f028b5101c0e0a9b0986e";
		String cert = "3082028030820226A00302010202060158F741F660300A06082A8648CE3D0403023053311D301B06035504030C144368696E6120556E69636F6D206553494D204341310E300C060355040B0C055653454E5331153013060355040A0C0C4368696E6120556E69636F6D310B300906035504060C02434E3022180F32303136313231333038313732355A180F32303137303631333038313732355A306C3124302206092A864886F70D010901161563616F6C7433406368696E61756E69636F6D2E636E3114301206035504030C0B5445535420445041555448310E300C060355040A0C055653454E533111300F06035504070C08424549204A494E47310B300906035504060C02434E3059301306072A8648CE3D020106082A8648CE3D0301070342000499C63872761294B3FC17A9D086985D857CA726B3EDCB214DCC90E5544C0538D1B0629059EF4C29A7921FBB9CC0ED9E6C030CF56F5DB67A27819F52F786A3D291A381C83081C5301F0603551D230418301680143BD3F57B34F44436E08F028B5101C0E0A9B0986E301D0603551D0E04160414C372BE814EFBE18C3AFF56E33766B33D507333EE300E0603551D0F0101FF04040302008030170603551D200101FF040D300B300906076781120102010430150603551D11040E300C880A2B0601040182F546020430430603551D1F043C303A3038A036A0348632687474703A2F2F31302E3139332E33302E33362F5441535343412F5441535343415F45554D2F43524C43657274692E43524C300A06082A8648CE3D0403020348003045022100DFA5D5DCE9E2590C09AFD8699C37C59554381D30D59E99A963336103552556AC02206396AFFC062B46E08EA19A592EBBD6C932F7A1DAD48D07BC26FE14F30F51B922";
		String ctxParams1 = "0102030405060708";
		List<String> apduList = ApduUtils.authenticateServerApdu(smdpSigned1, smdpSignature1, euiccCiPKIdToBeUsed, cert, ctxParams1);
		for (String apdu : apduList) {
			System.out.println(apdu);
		}
	}
	
	@Test
	public void getRATApduTest() {
		System.out.println(ApduUtils.getRATApdu());
	}
	
	@Test
	public void cancelSessionApduTest() {
		String transactionId = "80081122334455667701";
		String 	reason = "00";
		System.out.println(ApduUtils.cancelSessionApdu(transactionId, reason));
	}
	
	@Test
	public void prepareDownloadApduTest() {
		String smdpSigned2 = "300D8008e5cef1cd307e4445010101";
		String smdpSignature2 = "5F37406C3409470BE270A010F4447011227837F457DF0AFFC4D0A55E0E97661142194BF2A8A4CDC531B6EE596B07103D3012E566DEBB9CCF0B54453B27A37290A8E9BF";
		String smdpCertificate = "3082027E30820224A00302010202060158F741F6C8300A06082A8648CE3D0403023053311D301B06035504030C144368696E6120556E69636F6D206553494D204341310E300C060355040B0C055653454E5331153013060355040A0C0C4368696E6120556E69636F6D310B300906035504060C02434E3022180F32303136313231333038313732355A180F32303137303631333038313732355A306A3124302206092A864886F70D010901161563616F6C7433406368696E61756E69636F6D2E636E3112301006035504030C09544553542044505042310E300C060355040A0C055653454E533111300F06035504070C08424549204A494E47310B300906035504060C02434E3059301306072A8648CE3D020106082A8648CE3D030107034200046100A93B780FF3CDB83E62F5950E0E50B7CB0CCA6A031BCC328FEE47C04647F1ABCDF3AF1D24A9B9BF5E6AD8B5AC3A8B784182C8F35FC5A3A4AEF96BA750CC08A381C83081C5301F0603551D230418301680143BD3F57B34F44436E08F028B5101C0E0A9B0986E301D0603551D0E04160414349A7B4FE7C2BF8C8CE545D8994644D1372CB00D300E0603551D0F0101FF04040302008030170603551D200101FF040D300B300906076781120102010530150603551D11040E300C880A2B0601040182F546020430430603551D1F043C303A3038A036A0348632687474703A2F2F31302E3139332E33302E33362F5441535343412F5441535343415F45554D2F43524C43657274692E43524C300A06082A8648CE3D040302034800304502203717B7BD8FFF67277698AD9AD7F0A6113CA1FEA1583786C1C255A6F739DD8920022100BCDEB3F0A07B158A561AC0BC025C1A90CD838B633915BC2A07AB353A1608E545";
		String code = "D2FFE7A27BFAB816B67E58E7B2C5CDCB92363DC32CA7760F38D91B9D525B9EB0";
		List<String> apduList = ApduUtils.prepareDownloadApdu(smdpSigned2, smdpSignature2, smdpCertificate, code);
		for (String apdu : apduList) {
			System.out.println(apdu);
		}
	}
	
	@Test
	public void removeNotificationFromListApduTest() {
		String notifycounter = "04";
		System.out.println(ApduUtils.removeNotificationFromListApdu(notifycounter));
	}
	
	@Test
	public void listNotificationApduTest() {
		System.out.println(ApduUtils.listNotificationApdu());
	}
	
	@Test
	public void getNotifyCounterTest() {
		System.out.println(ApduUtils.getNotifyCounter());
	}
	
	@Test
	public void retrieveNotificationsListApduTest() {
		String notifycounter = "02";
		System.out.println(ApduUtils.retrieveNotificationsListApdu(notifycounter));
	}
	
	@Test
	public void loadBoundProfilePackageApduTest() {
		String BPP = "BF36820622BF2381A382010180081122334455667700840D800188810110840511223344555F494104C64BEC120BE34A4177A37F28BCA83E00B2ABBD0763F4FF0A507F12A29446F3C1A8F2EED30D229BEF097635D09CD64B643DECA1451AABACEC30916D8202CA10F75F374045ABA320D0111AC5FADDC1591C7C8AB64CE5BCB797B248529244E059DDF32FED632824D4B9EF34AD9D5EDF63D5D0A0B2EE97985822895A06EBEF02E4456A2C78A02A872859A04B3CD0843EF65D004437C4126C3A22F7EFCB655D467C5F8C7F992138369880610C408C1B178EA14A8848BF253D5A0AA0000102030405060708910431323334920870726F66696C6530930100940400110011950102B60C300A800204F0810431313131B705800300000054E89D3ECFDF0122A24A874826A4A4BCD291950A0392CD59074E7EF9FF8D526AA4D87DB584E06632877F90675BC4B0B04F2EE855A8ECB56CF2AD0F4A43A8E764941D32BC859AC8E65D539179135501CF986A56E2A38204B386820208C165C4B9376E9C2AAA6773D5AA9E20D34AA8BE822DCA417C23575C46FB007034CD102A0C7EE13811300430486A1C59767832129BBB8BF82EECC7EFAE445249D09B69E7446F32A32881E79FC20717BED40CB0D6029544B89D21E5FB4790E88FA2017657B8C2BC84C35F56897506A6C110C3476B00F1E3901BDC3B12570826F7B6058A55F396524572AB108449E6B8A7A9BB8A0D1203876E2C1A96365634B7F830CE6C836BEE676994D5A4F4D5FFABC58BB753E8BFCFA97AC290C427E39C132A259A91CF82E853129C5B9B851BC007F5047B818295BA86FEF23514C23901D5AB3D55DB68C1ED84A80A5DA1B2D8632C706314D36ECE414E7B32B62E02956EDBE7D1699B397C6D723CB4F884004DA4E6FF7263B530EC0E47382860F438BE624BE4CEAA768087A8B55D0F497FC03524393BB3886362FA545A8E22584CE23B871ACECEF84B944A1C62090CA30AAC68030228F39B266BDC318DCCD985638EE58129DE17F3EE3712C1910E4696AF0D24ADB89F1917376CA89685C8B48BEFD75F7BDA31FBA25AC75A0DB737A22F3213E79DDD031AE5FE3A434A74B1E211B130F559066B6EAF37A861C2B4AE7606DA4B00D89F4044FDE083926F2A339FD622EFB294AC10087A436C264B2AAC2B8AF2DBEB39F46A6052FA2A00BCC184FC7ECA4922B7A09839CE1FD9461ADB5F203EC94191067BA01D7CB6106D487D1DD86EF72566E90E655BD504AB400CDBC99E868202083BD0B9C37A5D800C8A8CAC12077EADE39498627808B816644C583A85B5E9D30FBB2CEAACBECB53DB836A412253CC31D991C41245F77162BE875C99B797ADB55829BB6E022788DAC3270EC8F17118AF82B3C151D1DA52C23ABCC98612D83BB7E82BD59BD2F0043FF15B36355CE1D45628C7EE298E4831FB9C5851AFDAF97821CB3F9DF2A31BABE333C878C4BE51F0A9E7D5FFF19163DF37A976EAAF46082A8B0D671581FDBA567117C442C5B77CF46AC941EA25D6934F527F5BF54BFDA533BD2D85992A2527277907C081BE759EA23A262D617104C704A5A4A86DFB1B4ED5C0CF90EF1993026F676D8B29F88FA6274D8590F1074D46DA722EE0F83F6684049B15C93E40D2DE65CC2B003E08922FBC06B092B263F10B691A6FBD6946306BC8527D3BB93F73CA2E096E0FBDE852C1369C6A5C77382696141CF09A6CD321A2AFB89B9C303144B0718E42BE52A463E28C52FE458F91CF249F88B53A670AAF9D9EDA5A1B9AE43ADA61CE0C71ECB552EA751723DA605176E0613658FBA9DF9D3EE7DA9976FD3DB8B08BD049FA42547CEDF0B9C8AB6A6FA5F306863E3DBDFE48B4A04320D381D40303D0E9B53E7D490C1D3B9F4B7F7C41F154B01A20188A5B47A21644C6B7ED8B11CB9673A3507C88668FA26A2A634E99FC7FC315E0086CEF25C7A1683A18F258032C583FCF555D6EE16D4A3AC8A1509B9FE5511A4495CEC738BBDAC414131DEAA928DF91A186819838731212CA15A24D00C30392812E19F0E4FF038F24021B582074E3743FDC5E7F5791C969E34FA0E1742909DED5BECB1B8D81DF64612B50D9791E3582BFA2EF7E71589B01575D524D8607DC087B91345749BD6BB79CCF0DAC8A497FEC684EF47D3234B448071A27F2CF4F3232472E2C88ED41248352D6BAB75C4BB67290E54AB441771FD28BC0CFEE08A6298E401D14D36496CF0726DFE46C";
		ProfileUtil util = new ProfileUtil();
		List<String[]> SBPP = util.generateSBPP(BPP);
		List<String> apduList = ApduUtils.loadBoundProfilePackageApdu(SBPP);
		System.out.println("loadBoundProfilePackageApduTest");
		for (String apdu : apduList) {
			System.out.println(apdu);
		}
	}
}